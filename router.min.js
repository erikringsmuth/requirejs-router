define([],function(){"use strict";var t={},n=!1,r={config:function(t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return n||(window.addEventListener?(window.addEventListener("hashchange",r.onUrlChange,!1),window.addEventListener("popstate",r.onUrlChange,!1)):(window.attachEvent("onhashchange",r.onUrlChange),window.attachEvent("popstate",r.onUrlChange)),n=!0),r},routes:{},activeRoute:{},onRouteLoad:function(){throw"`router.onRouteLoad(module, routeArguments)` has not been implemented."},loadCurrentRoute:function(){for(var t in r.routes)if(r.routes.hasOwnProperty(t)){var n=r.routes[t];if(r.testRoute(n)){r.activeRoute.active=!1,n.active=!0,r.activeRoute=n,require([n.moduleId],function(t){n.active&&r.onRouteLoad.call(r,t,r.routeArguments(n,r.currentUrl()))});break}}return r},onUrlChange:function(){r.loadCurrentRoute()},currentUrl:function(){return window.location.href},testRoute:function(t){var n=r.urlPath(r.currentUrl());if(t.path===n||"*"===t.path)return!0;if(t.path instanceof RegExp)return t.path.test(n);if(-1===t.path.indexOf("*")&&-1===t.path.indexOf(":"))return!1;var e=n.split("/"),i=t.path.split("/");if(e.length!==i.length)return!1;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];if(o!==e[a]&&"*"!==o&&":"!==o.charAt(0))return!1}return!0},routeArguments:function(t,n){var e={},i=r.urlPath(n),a=i.split("/"),o=[];!t||!t.path||t.path instanceof RegExp||(o=t.path.split("/"));for(var u in o)if(o.hasOwnProperty(u)){var s=o[u];":"===s.charAt(0)&&(e[s.substring(1)]=a[u])}var f=n.indexOf("?"),h="";if(-1!==f){h=n.substring(f);var l=h.indexOf("#");-1!==l&&(h=h.substring(0,l))}var p=n.indexOf("#/"),c=n.indexOf("#!/");if(-1!==p||-1!==c){var d="";d=n.substring(-1!==p?p:c),f=d.indexOf("?"),-1!==f&&(h=d.substring(f))}var v=h.substring(1).split("&");1===v.length&&""===v[0]&&(v=[]);for(var g in v)if(v.hasOwnProperty(g)){var w=v[g],b=w.split("=");e[b[0]]=b.splice(1,b.length-1).join("=")}for(var O in e){var R=e[O];e[O]="true"===R?!0:"false"===R?!1:isNaN(R)||""===R?decodeURIComponent(R):+R}return e},urlPath:function(n){if("undefined"!=typeof t[n])return t[n];var r=n.split("/"),e="/"+r.splice(3,r.length-3).join("/"),i=e.split(/[\?#]/)[0],a=e.indexOf("#");if(-1!==a){var o=e.substring(a).split("?")[0];"#/"===o.substring(0,2)?i=o.substring(1):"#!/"===o.substring(0,3)&&(i=o.substring(2))}return t[n]=i,i}};return r});