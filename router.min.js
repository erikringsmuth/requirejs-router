define([],function(){"use strict";var t={},r=!1,e={config:function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return r||(window.addEventListener?(window.addEventListener("hashchange",e.urlChangeEventHandler,!1),window.addEventListener("popstate",e.urlChangeEventHandler,!1)):(window.attachEvent("onhashchange",e.urlChangeEventHandler),window.attachEvent("popstate",e.urlChangeEventHandler)),r=!0),e},routes:{},activeRoute:{},routeLoadedCallback:function(){throw"`router.routeLoadedCallback(module, routeArguments)` has not been implemented."},loadCurrentRoute:function(){for(var t in e.routes)if(e.routes.hasOwnProperty(t)){var r=e.routes[t];if(e.testRoute(r)){e.activeRoute.active=!1,r.active=!0,e.activeRoute=r,require([r.moduleId],function(t){r.active&&e.routeLoadedCallback.call(e,t,e.routeArguments(r,e.currentUrl()))});break}}return e},urlChangeEventHandler:function(){e.loadCurrentRoute()},currentUrl:function(){return window.location.href},testRoute:function(t){if("function"==typeof t.testRoute)return t.testRoute.call(t);var r=e.urlPath(e.currentUrl());if("*"===t.path||t.path===r)return!0;if(-1===t.path.indexOf("*")&&-1===t.path.indexOf(":"))return!1;var n=r.split("/"),a=t.path.split("/");if(n.length!==a.length)return!1;for(var i in a)if(a.hasOwnProperty(i)){var u=a[i];if(u!==n[i]&&"*"!==u&&":"!==u.charAt(0))return!1}return!0},routeArguments:function(t,r){var n={},a=e.urlPath(r),i=a.split("/"),u=[];t&&t.path&&(u=t.path.split("/"));for(var o in u)if(u.hasOwnProperty(o)){var s=u[o];":"===s.charAt(0)&&(n[s.substring(1)]=i[o])}var l=r.indexOf("?"),f="";if(-1!==l){f=r.substring(l);var d=f.indexOf("#");-1!==d&&(f=f.substring(0,d))}var h=r.indexOf("#/"),v=r.indexOf("#!/");if(-1!==h||-1!==v){var c="";c=r.substring(-1!==h?h:v),l=c.indexOf("?"),-1!==l&&(f=c.substring(l))}var p=f.substring(1).split("&");1===p.length&&""===p[0]&&(p=[]);for(var g in p)if(p.hasOwnProperty(g)){var w=p[g],b=w.split("=");n[b[0]]=b.splice(1,b.length-1).join("=")}for(var O in n){var C=n[O];n[O]="true"===C?!0:"false"===C?!1:isNaN(C)||""===C?decodeURIComponent(C):+C}return n},urlPath:function(r){if("undefined"!=typeof t[r])return t[r];var e=r.split("/"),n="/"+e.splice(3,e.length-3).join("/"),a=n.split(/[\?#]/)[0],i=n.indexOf("#");if(-1!==i){var u=n.substring(i).split("?")[0];"#/"===u.substring(0,2)?a=u.substring(1):"#!/"===u.substring(0,3)&&(a=u.substring(2))}return t[r]=a,a}};return e});