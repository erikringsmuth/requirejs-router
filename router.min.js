define([],function(){"use strict";var r={},t=!1,n={config:function(r){for(var e in r)n[e]=r[e];for(var a in n.routes){var u=n.routes[a];if("undefined"==typeof u.path&&"undefined"==typeof u.matchesUrl)throw"Every route must have a path or matchesUrl()";"undefined"==typeof u.matchesUrl&&!function(r){r.matchesUrl=function(){return n.testRoute(r)}}(u)}return t||(window.addEventListener?(window.addEventListener("hashchange",n.urlChangeEventHandler,!1),window.addEventListener("popstate",n.urlChangeEventHandler,!1)):(window.attachEvent("onhashchange",n.urlChangeEventHandler),window.attachEvent("onpopstate",n.urlChangeEventHandler)),t=!0),n},routes:{},routeLoadedCallback:function(){throw"`router.routeLoadedCallback(module)` has not been implemented."},loadCurrentRoute:function(){var r=n.currentRoute();if(null!==r){var t=n.currentUrl();require([r.module],function(e){n.routeLoadedCallback.call(n,e,n.routeArguments(r,t))})}return n},currentRoute:function(){for(var r in n.routes){var t=n.routes[r];if(t.matchesUrl())return t}return null},urlChangeEventHandler:function(){n.loadCurrentRoute()},currentUrl:function(){return window.location.href},testRoute:function(r){var t=n.urlPath(n.currentUrl());if("*"===r.path||r.path===t)return!0;if(-1===r.path.indexOf("*")&&-1===r.path.indexOf(":"))return!1;var e=t.split("/"),a=r.path.split("/");if(e.length!==a.length)return!1;for(var u in a){var i=a[u];if(i!==e[u]&&"*"!==i&&":"!==i.charAt(0))return!1}return!0},routeArguments:function(r,t){var e={},a=n.urlPath(t),u=a.split("/"),i=[];r&&r.path&&(i=r.path.split("/"));for(var o in i){var s=i[o];":"===s.charAt(0)&&(e[s.substring(1)]=u[o])}var l=t.indexOf("?"),f="";if(-1!==l){f=t.substring(l);var d=f.indexOf("#");-1!==d&&(f=f.substring(0,d))}var h=t.indexOf("#/"),c=t.indexOf("#!/");if(-1!==h||-1!==c){var v="";v=t.substring(-1!==h?h:c),l=v.indexOf("?"),-1!==l&&(f=v.substring(l))}var p=f.substring(1).split("&");1===p.length&&""===p[0]&&(p=[]);for(var g in p){var b=p[g],w=b.split("=");e[w[0]]=w.splice(1,p.length-1).join("=")}for(var m in e){var C=e[m];e[m]="true"===C?!0:"false"===C?!1:isNaN(C)||""===C?decodeURIComponent(C):+C}return e},urlPath:function(t){if("undefined"!=typeof r[t])return r[t];var n=t.split("/"),e="/"+n.splice(3,n.length-3).join("/"),a=e.split(/[\?#]/)[0],u=e.indexOf("#");if(-1!==u){var i=e.substring(u).split("?")[0];"#/"===i.substring(0,2)?a=i.substring(1):"#!/"===i.substring(0,3)&&(a=i.substring(2))}return r[t]=a,a}};return n});