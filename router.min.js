define([],function(){"use strict";var r={},t=!1,n={config:function(r){for(var e in r)r.hasOwnProperty(e)&&(n[e]=r[e]);for(var a in n.routes)if(n.routes.hasOwnProperty(a)){var i=n.routes[a];if("undefined"==typeof i.path&&"undefined"==typeof i.matchesUrl)throw"Every route must have a path or matchesUrl()";"undefined"==typeof i.matchesUrl&&!function(r){r.matchesUrl=function(){return n.testRoute(r)}}(i)}return t||(window.addEventListener?(window.addEventListener("hashchange",n.urlChangeEventHandler,!1),window.addEventListener("popstate",n.urlChangeEventHandler,!1)):(window.attachEvent("onhashchange",n.urlChangeEventHandler),window.attachEvent("onpopstate",n.urlChangeEventHandler)),t=!0),n},routes:{},routeLoadedCallback:function(){throw"`router.routeLoadedCallback(module)` has not been implemented."},loadCurrentRoute:function(){var r=n.currentRoute();if(null!==r){var t=n.currentUrl();require([r.module],function(e){n.routeLoadedCallback.call(n,e,n.routeArguments(r,t))})}return n},currentRoute:function(){for(var r in n.routes)if(n.routes.hasOwnProperty(r)){var t=n.routes[r];if(t.matchesUrl())return t}return null},urlChangeEventHandler:function(){n.loadCurrentRoute()},currentUrl:function(){return window.location.href},testRoute:function(r){var t=n.urlPath(n.currentUrl());if("*"===r.path||r.path===t)return!0;if(-1===r.path.indexOf("*")&&-1===r.path.indexOf(":"))return!1;var e=t.split("/"),a=r.path.split("/");if(e.length!==a.length)return!1;for(var i in a)if(a.hasOwnProperty(i)){var u=a[i];if(u!==e[i]&&"*"!==u&&":"!==u.charAt(0))return!1}return!0},routeArguments:function(r,t){var e={},a=n.urlPath(t),i=a.split("/"),u=[];r&&r.path&&(u=r.path.split("/"));for(var o in u)if(u.hasOwnProperty(o)){var s=u[o];":"===s.charAt(0)&&(e[s.substring(1)]=i[o])}var f=t.indexOf("?"),l="";if(-1!==f){l=t.substring(f);var h=l.indexOf("#");-1!==h&&(l=l.substring(0,h))}var d=t.indexOf("#/"),c=t.indexOf("#!/");if(-1!==d||-1!==c){var v="";v=t.substring(-1!==d?d:c),f=v.indexOf("?"),-1!==f&&(l=v.substring(f))}var p=l.substring(1).split("&");1===p.length&&""===p[0]&&(p=[]);for(var g in p)if(p.hasOwnProperty(g)){var w=p[g],b=w.split("=");e[b[0]]=b.splice(1,b.length-1).join("=")}for(var O in e){var m=e[O];e[O]="true"===m?!0:"false"===m?!1:isNaN(m)||""===m?decodeURIComponent(m):+m}return e},urlPath:function(t){if("undefined"!=typeof r[t])return r[t];var n=t.split("/"),e="/"+n.splice(3,n.length-3).join("/"),a=e.split(/[\?#]/)[0],i=e.indexOf("#");if(-1!==i){var u=e.substring(i).split("?")[0];"#/"===u.substring(0,2)?a=u.substring(1):"#!/"===u.substring(0,3)&&(a=u.substring(2))}return r[t]=a,a}};return n});