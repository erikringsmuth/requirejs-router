define([],function(){"use strict";var t={},e=!1,r={config:function(t){for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return e||(window.addEventListener?(window.addEventListener("hashchange",r.urlChangeEventHandler,!1),window.addEventListener("popstate",r.urlChangeEventHandler,!1)):(window.attachEvent("onhashchange",r.urlChangeEventHandler),window.attachEvent("popstate",r.urlChangeEventHandler)),e=!0),r},routes:{},activeRoute:{},routeLoadedCallback:function(){throw"`router.routeLoadedCallback(module, routeArguments)` has not been implemented."},loadCurrentRoute:function(){for(var t in r.routes)if(r.routes.hasOwnProperty(t)){var e=r.routes[t];if(r.testRoute(e)){r.activeRoute.active=!1,e.active=!0,r.activeRoute=e,require([e.moduleId],function(t){e.active&&r.routeLoadedCallback.call(r,t,r.routeArguments(e,r.currentUrl()))});break}}return r},urlChangeEventHandler:function(){r.loadCurrentRoute()},currentUrl:function(){return window.location.href},testRoute:function(t){if("function"==typeof t.testRoute)return t.testRoute.call(t);var e=r.urlPath(r.currentUrl());if("*"===t.path||t.path===e)return!0;if(t.path instanceof RegExp)return t.path.test(e);if(-1===t.path.indexOf("*")&&-1===t.path.indexOf(":"))return!1;var n=e.split("/"),a=t.path.split("/");if(n.length!==a.length)return!1;for(var i in a)if(a.hasOwnProperty(i)){var u=a[i];if(u!==n[i]&&"*"!==u&&":"!==u.charAt(0))return!1}return!0},routeArguments:function(t,e){var n={},a=r.urlPath(e),i=a.split("/"),u=[];!t||!t.path||t.path instanceof RegExp||(u=t.path.split("/"));for(var o in u)if(u.hasOwnProperty(o)){var s=u[o];":"===s.charAt(0)&&(n[s.substring(1)]=i[o])}var f=e.indexOf("?"),l="";if(-1!==f){l=e.substring(f);var d=l.indexOf("#");-1!==d&&(l=l.substring(0,d))}var h=e.indexOf("#/"),c=e.indexOf("#!/");if(-1!==h||-1!==c){var v="";v=e.substring(-1!==h?h:c),f=v.indexOf("?"),-1!==f&&(l=v.substring(f))}var p=l.substring(1).split("&");1===p.length&&""===p[0]&&(p=[]);for(var g in p)if(p.hasOwnProperty(g)){var w=p[g],b=w.split("=");n[b[0]]=b.splice(1,b.length-1).join("=")}for(var O in n){var E=n[O];n[O]="true"===E?!0:"false"===E?!1:isNaN(E)||""===E?decodeURIComponent(E):+E}return n},urlPath:function(e){if("undefined"!=typeof t[e])return t[e];var r=e.split("/"),n="/"+r.splice(3,r.length-3).join("/"),a=n.split(/[\?#]/)[0],i=n.indexOf("#");if(-1!==i){var u=n.substring(i).split("?")[0];"#/"===u.substring(0,2)?a=u.substring(1):"#!/"===u.substring(0,3)&&(a=u.substring(2))}return t[e]=a,a}};return r});